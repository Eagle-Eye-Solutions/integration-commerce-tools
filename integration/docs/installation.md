# Plugin Installation

This plugin is a Node.js application that can be deployed in different ways and with different configurations.

## Commercetools connect

This plugin is certified and available to install via commercetools connect.

TODO

## Other deployment strategies

TODO

## Configuration

The plugin can be configured via environment variables. Each deployment strategy has a different way to define
environment variables, refer to the specific deployment documentation for further information.

| Variable                                   | Required | Default | Description                                                                                                                                                                                                                                                                                                                                                                                                            |
|--------------------------------------------|----------|---------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| CTP_PROJECT_KEY                            | âœ…        |         | The commercetools project key                                                                                                                                                                                                                                                                                                                                                                                          |
| CTP_REGION                                 | âœ…        |         | The commercetools region. E.g.: europe-west1.gcp                                                                                                                                                                                                                                                                                                                                                                       |
| CTP_CLIENT_ID                              | âœ…        |         | The commercetools client ID                                                                                                                                                                                                                                                                                                                                                                                            | 
| CTP_CLIENT_SECRET                          | âœ…        |         | The commercetools client secret                                                                                                                                                                                                                                                                                                                                                                                        |
| EE_CLIENT_ID                               | âœ…        |         | The clientId supplied by Eagle Eye during onboarding.                                                                                                                                                                                                                                                                                                                                                                  |
| EE_CLIENT_SECRET                           | âœ…        |         | The Eagle Eye secret                                                                                                                                                                                                                                                                                                                                                                                                   |
| EE_POS_URL                                 | âœ…        |         | The EagleEye POS API url                                                                                                                                                                                                                                                                                                                                                                                               |
| EE_INCOMING_IDENTIFIER                     | âœ…        |         | EagleEye Outlet Incoming Identifier                                                                                                                                                                                                                                                                                                                                                                                    |
| EE_PARENT_INCOMING_IDENTIFIER              | ðŸš«       |         | EagleEye Outlet's Parent unit Incoming Identifier                                                                                                                                                                                                                                                                                                                                                                      |
| CTP_SCOPE                                  | ðŸš«       |         | The commercetools client scope. The default value is empty                                                                                                                                                                                                                                                                                                                                                             |
| EE_API_CLIENT_TIMEOUT                      | ðŸš«       | 1800    | EagleEye API Client timeout. This timeout can be used to avoid the CT API request to fail when the circuit breaker functionality is disabled. If the circuit breaker is enabled and CIRCUIT_BREAKER_TIMEOUT is lower than EE_API_CLIENT_TIMEOUT then the circuit breaker timeout will trigger first.                                                                                                                   |
| CIRCUIT_BREAKER_TIMEOUT                    | ðŸš«       | 1700    | The time in milliseconds that action should be allowed to execute before timing out. Timeout can be disabled by setting this to `false`.                                                                                                                                                                                                                                                                               |
| CIRCUIT_BREAKER_RESET_TIMEOUT              | ðŸš«       | 30000   | The time in milliseconds to wait before setting the breaker to `halfOpen` state, and trying the action again                                                                                                                                                                                                                                                                                                           |
| CIRCUIT_BREAKER_ENABLED                    | ðŸš«       | true    | Whether the circuit breaker functionality is enabled                                                                                                                                                                                                                                                                                                                                                                   |
| CIRCUIT_BREAKER_ERROR_THRESHOLD_PERCENTAGE | ðŸš«       | 50      | The error percentage at which to open the circuit and start short-circuiting requests to fallback                                                                                                                                                                                                                                                                                                                      |
| ALWAYS_STORE_BASKET_IN_CUSTOM_OBJECT       | ðŸš«       | true    | When set to true the EagleEye enriched basked is saved every time the plugin calls the EagleEye API. Saving the basket increases the CT Cart API response time, to improve performance this option can be set to false and the basket should be saved ideally when the CT cart is frozen by passing the custom field `eagleeye-action` = `SAVE_BASKET`. [More info](how-it-works.md#storing-eagle-eye-enriched-basket) |
